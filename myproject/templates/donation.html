<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Donor Landing Page</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      /* Background Gradient */
      body {
        background: linear-gradient(120deg, #f9ecec, #e5f5f5);
        font-family: "Arial", sans-serif;
        margin: 0;
        padding: 0;
      }

      .container {
        margin-top: 20px;
      }

      .card {
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      /* Left Section */
      .left-section {
        background-color: rgba(255, 255, 255, 0.8);
        padding: 20px;
        border-radius: 10px;
      }

      /* Right Section */
      .right-section {
        background-color: rgba(245, 236, 207, 0.8);
        padding: 20px;
        border-radius: 10px;
      }

      /* Center Section */
      .center-section {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }

      .donate-button {
        background-color: #e63946;
        color: white;
        border: none;
        font-size: 18px;
        padding: 10px;
        transition: all 0.3s ease;
      }

      .donate-button:hover {
        background-color: #b02737;
        transform: scale(1.05);
      }

      /* Fancy Text */
      .fancy-text {
        font-family: "Georgia", serif;
        font-size: 24px;
        font-style: italic;
        text-align: center;
        color: #444;
      }

      /* My Donations Section */
      .my-donations {
        background-color: rgba(230, 242, 255, 0.8);
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
      }

      /* Carousel Styling */
      .carousel-inner {
        height: 120px;
        overflow: hidden;
        text-align: center;
        font-size: 18px;
        color: #555;
      }

      .carousel-item {
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Welcome Text -->
      <div class="text-center mb-5">
        <h1 class="text-danger">NEU Silicon Valley Food Bank</h1>
        <p class="fancy-text">
          "Making a difference starts with one step, one dollar, one donation at
          a time."
        </p>
      </div>

      <div class="row">
        <!-- Left Section: Previous Donations -->
        <div class="col-md-3 left-section">
          <h4 class="text-center">Previous Donations</h4>
          <div
            id="donorCarousel"
            class="carousel slide mt-3"
            data-bs-ride="carousel"
          >
            <div class="carousel-inner" id="donorList">
              <!-- Carousel items added dynamically -->
            </div>
          </div>
        </div>

        <!-- Center Section: Donation Form -->
        <div class="col-md-6 center-section">
          <h4 class="text-center">Donate to NEU Silicon Valley Food Bank</h4>
          <form id="donationForm" class="mt-3">
            <div class="form-check">
              <input
                class="form-check-input donation-option"
                type="checkbox"
                name="donation"
                value="5"
                id="option5"
              />
              <label class="form-check-label" for="option5">$5</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input donation-option"
                type="checkbox"
                name="donation"
                value="25"
                id="option25"
              />
              <label class="form-check-label" for="option25">$25</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input donation-option"
                type="checkbox"
                name="donation"
                value="50"
                id="option50"
              />
              <label class="form-check-label" for="option50">$50</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input donation-option"
                type="checkbox"
                name="donation"
                value="100"
                id="option100"
              />
              <label class="form-check-label" for="option100">$100</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input donation-option"
                type="checkbox"
                name="donation"
                value="200"
                id="option200"
              />
              <label class="form-check-label" for="option200">$200</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input donation-option"
                type="checkbox"
                name="donation"
                value="500"
                id="option500"
              />
              <label class="form-check-label" for="option500">$500</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input donation-option"
                type="checkbox"
                name="donation"
                value="1000"
                id="option1000"
              />
              <label class="form-check-label" for="option1000">$1000</label>
            </div>
            <div class="mt-3">
              <label for="customAmount">Custom Amount:</label>
              <input
                type="number"
                class="form-control"
                id="customAmount"
                placeholder="Enter custom amount"
              />
            </div>
            <button
              type="button"
              id="donateButton"
              class="btn donate-button mt-3 w-100"
            >
              Donate
            </button>
          </form>
        </div>

        <!-- Right Section: Food Bank Info -->
        <div class="col-md-3 right-section">
          <h4 class="text-center">Food Bank Info</h4>
          <p><strong>Location:</strong> NEU Silicon Valley Food Bank</p>
          <p><strong>Operation Time:</strong> Mon-Fri, 9 AM - 5 PM</p>
          <p><strong>Phone:</strong> (123) 456-7890</p>
        </div>
      </div>

      <!-- My Previous Donations Section -->
      <div class="my-donations">
        <h4 class="text-center">My Previous Donations</h4>
        <ul id="userDonations" class="list-group mt-3">
          <!-- User donations added dynamically -->
        </ul>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // remove following once connected with backend
      document.addEventListener("DOMContentLoaded", () => {
        const donorCarousel = document.getElementById("donorList");
        const userDonations = document.getElementById("userDonations");

        // Mock data
        const allDonations = [
          { name: "John Doe", amount: 50 },
          { name: "Jane Smith", amount: 100 },
          { name: "Sam Johnson", amount: 200 },
        ];

        const userDonationHistory = [
          { date: "2023-10-01", amount: 50 },
          { date: "2023-11-10", amount: 100 },
          { date: "2024-01-15", amount: 200 },
        ];

        // Populate carousel for all donations
        allDonations.forEach((donation, index) => {
          const item = document.createElement("div");
          item.className = `carousel-item ${index === 0 ? "active" : ""}`;
          item.innerText = `${donation.name}: $${donation.amount}`;
          donorCarousel.appendChild(item);
        });

        // Populate user's previous donations
        userDonationHistory.forEach((donation) => {
          const listItem = document.createElement("li");
          listItem.className = "list-group-item";
          listItem.innerText = `Date: ${donation.date}, Amount: $${donation.amount}`;
          userDonations.appendChild(listItem);
        });
      });

      // load donations
      async function fetchDonations() {
          const response = await fetch("/donor/");
          const data = await response.json();

          if (response.ok) {
              // Populate user donations
              const userDonations = document.getElementById("userDonations");
              data.user_donations.forEach((donation) => {
                  const listItem = document.createElement("li");
                  listItem.className = "list-group-item";
                  listItem.innerText = `Date: ${donation.date}, Amount: $${donation.amount}`;
                  userDonations.appendChild(listItem);
              });

              // Populate carousel with all donations
              const donorCarousel = document.getElementById("donorList");
              data.all_donations.forEach((donation, index) => {
                  const item = document.createElement("div");
                  item.className = `carousel-item ${index === 0 ? "active" : ""}`;
                  item.innerText = `${donation.name}: $${donation.amount}`;
                  donorCarousel.appendChild(item);
              });
          } else {
              alert(`Error: ${data.error}`);
          }
      }

      // Call fetchDonations on page load
      document.addEventListener("DOMContentLoaded", fetchDonations);


      // submit donation
      document
        .getElementById("donateButton")
        .addEventListener("click", async () => {
          const customAmountInput = document.getElementById("customAmount");
          const donationOptions = document.querySelectorAll(".donation-option");

          // Validate amount
          const selectedAmount =
            customAmountInput.value ||
            [...donationOptions].find((opt) => opt.checked)?.value;

          if (!selectedAmount || parseFloat(selectedAmount) <= 0) {
            alert("Please select a valid donation amount.");
            return;
          }

          // Submit donation
          const response = await fetch("/donor/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ amount: selectedAmount }),
          });

          const data = await response.json();
          if (response.ok) {
            alert(data.message);
            window.location.reload(); // Reload to update UI
          } else {
            alert(`Error: ${data.error}`);
          }
        });
    </script>
  </body>
</html>
